<!--
 * @Author: Jandan
 * @Date: 2021-02-08 01:42:32
 * @LastEditTime: 2021-02-09 02:11:32
 * @Description:
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/layui/css/layui.css" />
    <style>
      .layui-fluid {
        padding: 15px;
      }
    </style>
    <script src="/layui/layui.js"></script>
  </head>
  <body>
    <div class="layui-fluid">
      <form class="layui-form">
        <input type="hidden" name="id" value="{$info.id}" />
        <div class="layui-form-item">
          <label class="layui-form-label">用户名</label>
          <div class="layui-input-block">
            <input
              type="text"
              name="username"
              value="{$info.username}"
              autocomplete="off"
              placeholder="请输入用户名"
              class="layui-input"
            />
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">性别</label>
          <div class="layui-input-block">
            <input type="radio" name="sex" value="1" title="男" {if $info.sex==1 }checked{/if} /> <input type="radio"
            name="sex" value="0" title="女" {if $info.sex==0 }checked{/if} />
          </div>
        </div>
        <div class="layui-form-item">
          <div class="layui-input-block">
            <button type="submit" class="layui-btn" lay-submit="save" lay-filter="save">立即提交</button>
          </div>
        </div>
      </form>
    </div>
    <script>
      layui.use(['form', 'jquery'], function () {
        const form = layui.form,
          layer = layui.layer,
          $ = layui.jquery

        //监听提交
        form.on('submit(save)', function (data) {
          $.ajax({
            url: "{:url('save')}",
            data: data.field,
            type: 'POST',
            success: function (response) {
              if (response.code === 0) {
                layer.msg(response.msg, { icon: 6, time: 1000 }, function () {
                  const index = parent.layer.getFrameIndex(window.name)
                  parent.layer.close(index)
                  parent.layui.table.reload('LAY_table_user')
                })
              } else {
                layer.alert(response.msg, { icon: 5 }, function (index) {
                  layer.close(index)
                })
              }
            },
          })
          return false
        })
      })
    </script>
  </body>
</html>
